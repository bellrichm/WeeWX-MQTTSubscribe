environment:
  # common values
  SONAR_SCANNER_VERSION: 4.2.0.1873
  SONAR_SCANNER_OPTS: -server
  # default values
  APPVEYOR_BUILD_WORKER_IMAGE: Ubuntu1804
  PYTHON: 3.6
  WEEWX: 4.0.0b18
  WEEWX_URL: http://www.weewx.com/downloads/released_versions/

  matrix:
    - job_name: %WEEWX%-py%PTHON%
      job_group: build
      job_depends_on: initialize
      WEEWX_URL: http://www.weewx.com/downloads/development_versions/
      CODECOVIO_UPLOAD: true
      COVERALLS_UPLOAD: true
      SONAR_UPLOAD: true

    - job_name: weewx4-py2
      job_group: build  
      job_depends_on: initialize
      PYTHON: 2.7
      WEEWX_URL: http://www.weewx.com/downloads/development_versions/
      CODECOVIO_UPLOAD: true

    - job_name: weewx3-py2
      job_group: build
      job_depends_on: initialize
      WEEWX: 3.9.2
      PYTHON: 2.7

    - job_name: initialize

    - job_name: finalize
      job_depends_on: build

stack: python %PYTHON%      

for:
- 
  matrix:
    only:
    - job_name: finalize

  build_script:
    - sh: echo "finalize"

- 
  matrix:
    only:
    - job_group: build

  build_script:
    - sh: echo "build_script"
    #- sh: appveyor/build_script.sh  

  test_script:
    - sh: echo "test_script"
    #- sh: appveyor/test_script.sh

  after_test:
    - sh: echo "after_test"
    #- sh: appveyor/after_test.sh

  on_finish:
    - sh: echo "on_finish"
    #- sh: appveyor/on_finish.sh

init:
  # This runs before the commit is even checked out
  - sh: echo "init"

install:
  # 'source' so that variables are set in parent environment
  - sh: echo "install"
  #- sh: source appveyor/init.sh 
  #- sh: appveyor/install.sh    
   